//
//  ViewController.swift
//  UITableView and UICollectionView (Instagram)
//
//  Created by Alexandr Garkalin on 17.10.2024.
//

import UIKit

final class HomeViewController: UIViewController {

    //MARK: - –û–±—ä–µ–∫—Ç—ã –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –±–∞—Ä–∞
    private let instagramButton = UIButton(type: .custom)
    private let heartButton = UIButton(type: .custom)
    private let messageButtonItem = UIBarButtonItem(image: UIImage(named: "message"), style: .plain, target: nil, action: nil)
    
    //MARK: - –û–±—ä–µ–∫—Ç—ã –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã
    private var myTableView = UITableView()
    private var refreshControl = UIRefreshControl()
    
    //MARK: - –û–±—ä–µ–∫—Ç—ã –¥–ª—è —Å—Ç–æ—Ä–∏—Å
    private let yourStorysPhoto = UIImageView()
    private let neymarStorysPhoto = UIImageView()
    private let messiStorysPhoto = UIImageView()
    private let ronaldoStorysPhoto = UIImageView()
    private let mbappeStorysPhoto = UIImageView()
    private let viniciusStorysPhoto = UIImageView()
    private let modricStorysPhoto = UIImageView()
    private let yourLabel = UILabel()
    private let neymarLabel = UILabel()
    private let messiLabel = UILabel()
    private let ronaldoLabel = UILabel()
    private let mbappeLabel = UILabel()
    private let viniciusLabel = UILabel()
    private let modricLabel = UILabel()
    private var images = [UIImage(named: "Messi"), UIImage(named: "Ronaldo"), UIImage(named: "Mbappe"), UIImage(named: "Neymar"), UIImage(named: "Vinicius"), UIImage(named: "Modric"), UIImage(named: "YourStorys")]
    
    //MARK: - –û–±—ä–µ–∫—Ç—ã –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Å—Ç–∞
    private let userMessiHeartLabel = UILabel()
    private let userMessiMessageLabel = UILabel()
    private let userMessiShareLabel = UILabel()
    
    //MARK: - –û–±—ä–µ–∫—Ç—ã –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –ø–æ—Å—Ç–∞
    private let userMbappeHeartLabel = UILabel()
    private let userMbappeMessageLabel = UILabel()
    private let userMbappeShareLabel = UILabel()
    
    //MARK: - –û–±—ä–µ–∫—Ç—ã –¥–ª—è —Ç—Ä–µ—Ç—å–µ–≥–æ –ø–æ—Å—Ç–∞
    private let userNeymarHeartLabel = UILabel()
    private let userNeymarMessageLabel = UILabel()
    private let userNeymarShareLabel = UILabel()
    
    
    //MARK: - viewDidLoad
    override func viewDidLoad() {
        super.viewDidLoad()
        view.backgroundColor = .white
        
        // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤
        addTabBarItem()
        addNavControllerItems()
        addMyTableView()
        
    }
    
    //MARK: - –ú–µ—Ç–æ–¥—ã
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç tabBar
    private func addTabBarItem() {
        let tabBarItem = UITabBarItem(title: nil, image: UIImage(named: "unselectHouse"), selectedImage: UIImage(named: "selectHouse"))
        tabBarItem.imageInsets = UIEdgeInsets(top: 7, left: 0, bottom: 0, right: 0)
        self.tabBarItem = tabBarItem
        tabBarController?.selectedIndex = 0
    }
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
    private func addNavControllerItems() {
        // –ö–Ω–æ–ø–∫–∞ "Instagram" (–≤ –¥–∞–Ω–Ω–æ–º –∑–∞–¥–∞–Ω–∏–∏ –±–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞)
        var config = UIButton.Configuration.plain()
        config.image = UIImage(named: "Instagram")
        config.baseForegroundColor = .black
        config.contentInsets = NSDirectionalEdgeInsets(top: 0, leading: -30, bottom: 0, trailing: 0) // —Å–¥–≤–∏–≥–∞–µ–º —á—É—Ç—å –≤–ª–µ–≤–æ –Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–º—É –±–∞—Ä—É
        instagramButton.configuration = config
        let instagramButtonItem = UIBarButtonItem(customView: instagramButton)
        navigationItem.leftBarButtonItem = instagramButtonItem
        
        // –∫–Ω–æ–ø–∫–∞ —Å–µ—Ä–¥–µ—á–∫–æ (—Å –æ—Ç—Å—Ç—É–ø–æ–º –≤–ø—Ä–∞–≤–æ) –∏ —Å–æ–æ–±—â–µ–Ω–∏—è
        var config2 = UIButton.Configuration.plain()
        config2.image = UIImage(named: "heart")
        config2.baseForegroundColor = .black
        config2.contentInsets = NSDirectionalEdgeInsets(top: 0, leading: 0, bottom: 0, trailing: -20) // —Å–¥–≤–∏–≥–∞–µ–º —Å–µ—Ä–¥–µ—á–∫–æ –±–ª–∏–∂–µ –∫ —Å–æ–æ–±—â–µ–Ω–∏—è–º
        heartButton.configuration = config2
        let heartBarButtonItem = UIBarButtonItem(customView: heartButton)
        
        messageButtonItem.tintColor = .black
        navigationItem.rightBarButtonItems = [messageButtonItem, heartBarButtonItem]
    }
    
    // –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º refreshControl
    private func addMyTableView() {
        myTableView = UITableView(frame: view.bounds, style: .plain)
        myTableView.register(StorysScrollTableViewCell.self, forCellReuseIdentifier: "StorysScrollTableViewCell")
        myTableView.register(PostTableViewCell.self, forCellReuseIdentifier: "PostTableViewCell")
        myTableView.register(RecommendationsViewCell.self, forCellReuseIdentifier: "RecommendationsViewCell")
        myTableView.separatorStyle = .none
        myTableView.showsVerticalScrollIndicator = false
        myTableView.delegate = self
        myTableView.dataSource = self
        myTableView.refreshControl = refreshControl
        refreshControl.addTarget(self, action: #selector(refreshData), for: .valueChanged)
        view.addSubview(myTableView)
    }
    
    @objc private func refreshData() {
        //myTableView.reloadData() - –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ –Ω—É–∂–Ω–æ, –ª–∏—à—å –≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
        refreshControl.endRefreshing()
    }
    
}

//MARK: UITableView Data Source and UITableViewDelegate

extension HomeViewController: UITableViewDelegate, UITableViewDataSource {
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        return 5
    }
    
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        if indexPath.row == 0 {
            let cell = tableView.dequeueReusableCell(withIdentifier: "StorysScrollTableViewCell", for: indexPath) as! StorysScrollTableViewCell
            if images[indexPath.row] != nil {
                cell.addImage(storysImage: yourStorysPhoto, image: images[6]!, x: 10,nicknameLabel: yourLabel, nickname: "–í–∞—à–∞ –∏—Å—Ç–æ—Ä–∏—è", storysInactive: true)
                cell.addImage(storysImage: neymarStorysPhoto, image: images[3]!, x: 110, nicknameLabel: neymarLabel, nickname: "neymarjr", storysInactive: false)
                cell.addImage(storysImage: messiStorysPhoto, image: images[0]!, x: 210, nicknameLabel: messiLabel, nickname: "leomessi", storysInactive: false)
                cell.addImage(storysImage: mbappeStorysPhoto, image: images[2]!, x: 310, nicknameLabel: mbappeLabel, nickname: "k.mbappe", storysInactive: false)
                cell.addImage(storysImage: ronaldoStorysPhoto, image: images[1]!, x: 410, nicknameLabel: ronaldoLabel, nickname: "cristiano", storysInactive: false)
                cell.addImage(storysImage: viniciusStorysPhoto, image: images[4]!, x: 510, nicknameLabel: viniciusLabel, nickname: "vinijr", storysInactive: false)
                cell.addImage(storysImage: modricStorysPhoto, image: images[5]!, x: 610, nicknameLabel: modricLabel, nickname: "lukamodric10", storysInactive: false)
            }
            return cell
        } else if indexPath.row == 1 {
            let cell = tableView.dequeueReusableCell(withIdentifier: "PostTableViewCell", for: indexPath) as! PostTableViewCell
            cell.addUserPhoto(named: "Messi")
            cell.addUserNickname(text: "leomessi")
            cell.addVerificationImageView(x: 0)
            cell.addTimePost(text: "4 —á.")
            cell.addImagePost(named: "messiPost")
            cell.addQuantityActivity(quantityLabel: userMessiHeartLabel, text: "9,2 –º–ª–Ω", x: 40)
            cell.addQuantityActivity(quantityLabel: userMessiMessageLabel, text: "120 —Ç—ã—Å.", x: 150)
            cell.addQuantityActivity(quantityLabel: userMessiShareLabel, text: "196 —Ç—ã—Å.", x: 260)
            cell.addMessagePost(nickname: "leomessi", text: "Ten√≠a muchas ganas de volver a jugar en Argentina y me emociona m√°s que nunca el cari√±o y la conexi√≥n con la gente. Seguimos adelante con la misma ilusi√≥n!")
            cell.addDateLabel(text: "16 –æ–∫—Ç—è–±—Ä—è ‚Ä¢")
            return cell
        } else if indexPath.row == 2 {
            let cell = tableView.dequeueReusableCell(withIdentifier: "RecommendationsViewCell", for: indexPath) as! RecommendationsViewCell
            return cell
        } else if indexPath.row == 3 {
            let cell = tableView.dequeueReusableCell(withIdentifier: "PostTableViewCell", for: indexPath) as! PostTableViewCell
            cell.addUserPhoto(named: "Mbappe")
            cell.addUserNickname(text: "k.mbappe")
            cell.addVerificationImageView(x: 5)
            cell.addTimePost(text: "6 —á.")
            cell.addImagePost(named: "mbappePost")
            cell.addQuantityActivity(quantityLabel: userMbappeHeartLabel, text: "4,4 –º–ª–Ω", x: 40)
            cell.addQuantityActivity(quantityLabel: userMbappeMessageLabel, text: "19,6 —Ç—ã—Å.", x: 150)
            cell.addQuantityActivity(quantityLabel: userMbappeShareLabel, text: "23,5 —Ç—ã—Å.", x: 260)
            cell.addMessagePost(nickname: "k.mbappe", text: "My first Champions League night at home. üè†ü§ç It was incredible to feel the support from our fans, and the energy on the field was amazing. We're pushing forward together! ‚ö™Ô∏èüîµ")
            cell.addDateLabel(text: "12 –æ–∫—Ç—è–±—Ä—è ‚Ä¢")
            return cell
        } else {
            let cell = tableView.dequeueReusableCell(withIdentifier: "PostTableViewCell", for: indexPath) as! PostTableViewCell
            cell.addUserPhoto(named: "Neymar")
            cell.addUserNickname(text: "neymarjr")
            cell.addVerificationImageView(x: 5)
            cell.addTimePost(text: "7 —á.")
            cell.addImagePost(named: "neymarPost")
            cell.addQuantityActivity(quantityLabel: userNeymarHeartLabel, text: "4,9 –º–ª–Ω", x: 40)
            cell.addQuantityActivity(quantityLabel: userNeymarMessageLabel, text: "120 —Ç—ã—Å.", x: 150)
            cell.addQuantityActivity(quantityLabel: userNeymarShareLabel, text: "430 —Ç—ã—Å.", x: 260)
            cell.addMessagePost(nickname: "neymarjr", text: "Feliz de estar sentindo este sentimento novamente, friozinho na barriga pr√© jogo √© sempre muito bom.. que seja um retorno cheio de sa√∫de! Que Deus nos aben√ßoe e nos proteja üôèüíô")
            cell.addDateLabel(text: "3 –æ–∫—Ç—è–±—Ä—è ‚Ä¢")
            return cell
        }
    }
    
    
    func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -> CGFloat {
        if indexPath.row == 0 {
            return 140 // –≤—ã—Å–æ—Ç–∞ —è—á–µ–π–∫–∏ —Å—Ç–æ—Ä–∏—Å
        } else if indexPath.row == 2  {
            return 330 // –≤—ã—Å–æ—Ç–∞ —è—á–µ–π–∫–∏ —Å–µ–∫—Ü–∏–∏ "–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ"
        } else {
            return 750 // –≤—ã—Å–æ—Ç–∞ –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤
        }
        }
    
    // –ó–∞–ø—Ä–µ—â–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —è—á–µ–µ–∫ —Ç–∞–±–ª–∏—Ü—ã
    func tableView(_ tableView: UITableView, shouldHighlightRowAt indexPath: IndexPath) -> Bool {
        return false
    }
}

